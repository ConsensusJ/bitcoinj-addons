buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.2'
        classpath 'com.github.jruby-gradle:jruby-gradle-plugin:0.4.0'
        classpath 'org.ajoberstar:gradle-git:1.3.0'
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.3.1'
    }
}

ext.groovyVersion = '2.4.5'

allprojects {
    apply plugin: 'java'
    apply plugin: 'groovy'

    version = bitcoinjAddonsVersion     // set in gradle.properties
    group = 'com.msgilligan'

    repositories {
        jcenter()
    }
}

subprojects {
    dependencies {
        compile 'org.bitcoinj:bitcoinj-core:0.13.3'
        compile 'org.slf4j:slf4j-api:1.7.7'

        testCompile "org.codehaus.groovy:groovy:${groovyVersion}"
        testCompile("org.spockframework:spock-core:1.0-groovy-2.4") {
            exclude module: "groovy-all"
        }
    }
}

apply from: 'gradle/idea.gradle'
apply from: 'gradle/javadoc.gradle'
apply from: 'gradle/asciidoctor.gradle'
apply from: 'gradle/github-pages.gradle'
apply from: 'gradle/bintray.gradle'

task testReport(type: TestReport) {
    destinationDir = file("$buildDir/reports/allTests")
    // Include the results from the `test` task in all subprojects
    reportOn subprojects*.test
}

task jenkinsBuild(dependsOn: [build, testReport, javadocAll, asciidoctor])
